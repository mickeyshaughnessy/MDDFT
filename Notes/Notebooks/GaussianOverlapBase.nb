(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     59868,       1333]
NotebookOptionsPosition[     58977,       1303]
NotebookOutlinePosition[     59417,       1322]
CellTagsIndexPosition[     59374,       1319]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"n", ",", "x"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modSphBesselI", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"Pi", "/", 
      RowBox[{"(", 
       RowBox[{"2", "x"}], ")"}]}], "]"}], 
    RowBox[{"BesselI", "[", 
     RowBox[{
      RowBox[{"n", "+", 
       RowBox[{"1", "/", "2"}]}], ",", "x"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mform", "[", "M_", "]"}], " ", ":=", " ", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"N", "[", "M", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, 3.6177338648770723`*^9, {
   3.6177362075100183`*^9, 3.6177362153163424`*^9}, {3.61773680487084*^9, 
   3.61773680778008*^9}, {3.617746083529738*^9, 3.617746088945554*^9}, {
   3.617749289862195*^9, 3.6177493000834627`*^9}, {3.617895742394669*^9, 
   3.617895833464714*^9}, {3.617987587111926*^9, 3.617987587919772*^9}, {
   3.617988087589916*^9, 3.61798811374889*^9}, {3.617996621709051*^9, 
   3.617996634106614*^9}, {3.61799666733936*^9, 3.617996716772345*^9}, {
   3.61918213713881*^9, 3.619182154621798*^9}, {3.61918219566053*^9, 
   3.619182235728363*^9}, {3.619472483867281*^9, 3.619472487431353*^9}, {
   3.619473011875802*^9, 3.619473016514689*^9}, {3.619473109049328*^9, 
   3.619473140783165*^9}, {3.619473280439212*^9, 3.619473306020043*^9}, {
   3.6194740985381107`*^9, 3.61947410084761*^9}, 3.61947420144806*^9, {
   3.624299464255987*^9, 3.624299465904708*^9}, {3.6242995698975573`*^9, 
   3.62429957110598*^9}, {3.624413357655827*^9, 3.624413360542245*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "r", ",", "x", ",", "y", ",", "z", ",", "RADIUS", ",", "THETA", ",", 
    "PHI"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cart2sphPolar", " ", "=", " ", 
   RowBox[{"CoordinateTransformData", "[", 
    RowBox[{
     RowBox[{"\"\<Cartesian\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",", 
     "\"\<Mapping\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RADIUS", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ",", 
     RowBox[{"THETA", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ",", 
     RowBox[{"PHI", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}]}], "}"}], " ", "=", " ", 
   RowBox[{"cart2sphPolar", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sphPolar2cart", " ", "=", " ", 
   RowBox[{"CoordinateTransformData", "[", 
    RowBox[{
     RowBox[{"\"\<Spherical\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",", 
     "\"\<Mapping\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"r", ",", "theta", ",", "phi"}], "]"}], ",", 
    RowBox[{"Y", "[", 
     RowBox[{"r", ",", "theta", ",", "phi"}], "]"}], ",", 
    RowBox[{"Z", "[", 
     RowBox[{"r", ",", "theta", ",", "phi"}], "]"}]}], "}"}], "=", 
  RowBox[{"sphPolar2cart", "[", 
   RowBox[{"{", 
    RowBox[{"r", ",", "theta", ",", "phi"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<cart to sph map: \>\"", ",", 
    RowBox[{"cart2sphPolar", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<sph polar map:\>\"", " ", ",", 
    RowBox[{"sphPolar2cart", "[", 
     RowBox[{"{", 
      RowBox[{"r", ",", "theta", ",", "phi"}], "}"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, 3.6177338648770723`*^9, {
   3.6177362075100183`*^9, 3.6177362153163424`*^9}, {3.61773680487084*^9, 
   3.61773680778008*^9}, {3.617746083529738*^9, 3.617746088945554*^9}, {
   3.617749289862195*^9, 3.6177493000834627`*^9}, {3.617895742394669*^9, 
   3.617895833464714*^9}, {3.617987587111926*^9, 3.617987587919772*^9}, {
   3.617988087589916*^9, 3.61798811374889*^9}, {3.617996621709051*^9, 
   3.617996634106614*^9}, {3.61799666733936*^9, 3.617996716772345*^9}, {
   3.61918213713881*^9, 3.619182154621798*^9}, {3.61918219566053*^9, 
   3.619182235728363*^9}, {3.619472483867281*^9, 3.619472487431353*^9}, {
   3.6194825526705236`*^9, 3.6194825536300383`*^9}, {3.619482653412937*^9, 
   3.619482718568288*^9}, {3.624273914397114*^9, 3.6242739148119698`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"gaussian", " ", "kernel"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"r", ",", "sigma", ",", "g", ",", "Delta"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Delta", "[", 
      RowBox[{"r_", ",", "s_"}], "]"}], " ", "=", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "^", "2"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"s", "^", "2"}], ")"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, 3.6177338648770723`*^9, {
   3.6177362075100183`*^9, 3.6177362153163424`*^9}, {3.61773680487084*^9, 
   3.61773680778008*^9}, {3.617846169899548*^9, 3.61784618540868*^9}, {
   3.6191819973860617`*^9, 3.61918205574105*^9}, {3.6191830700993547`*^9, 
   3.619183086738825*^9}, {3.61918312118473*^9, 3.619183123943438*^9}, {
   3.62129323005779*^9, 3.62129325961283*^9}, {3.621293303479686*^9, 
   3.621293337463072*^9}, {3.621293581581361*^9, 3.621293608592575*^9}, {
   3.621294722847096*^9, 3.621294739824625*^9}, 3.624299422251828*^9, {
   3.624299488054195*^9, 3.624299504059471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"delta", ":", " ", 
    RowBox[{"smoothing", " ", "kernel"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"d", ",", "r", ",", "s", ",", "sigma", ",", "g", ",", "G"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"delta", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], "=", 
     RowBox[{"Delta", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"x", "-", "y"}], "]"}], ",", "s"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rho1", "[", "x_List", "]"}], " ", ":=", " ", 
     RowBox[{"delta", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "s"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rho2", "[", "x_List", "]"}], " ", ":=", " ", 
     RowBox[{"delta", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"r0", ",", "0", ",", "0"}], "}"}], ",", "s"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"inner", " ", "product"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"r0_", ",", "s_"}], "]"}], " ", "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rho1", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], 
        RowBox[{"rho2", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "s", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Im", "[", "s", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Re", "[", "r0", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Im", "[", "r0", "]"}], "\[Equal]", "0"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"G", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], "=", 
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"x", "-", "y"}], "]"}], ",", "s"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"r0_", ",", "s_"}], "]"}], " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"0", ",", "s"}], "]"}], "-", 
         RowBox[{"g", "[", 
          RowBox[{"r0", ",", "s"}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, {3.6177338648770723`*^9, 
   3.617733873568713*^9}, {3.6178456081615953`*^9, 3.617845655751833*^9}, {
   3.617845693636935*^9, 3.61784575466188*^9}, 3.617845803642646*^9, 
   3.61784622463955*^9, {3.617847158526813*^9, 3.617847173138172*^9}, {
   3.61788906836418*^9, 3.617889069576985*^9}, {3.617890137064266*^9, 
   3.61789013799082*^9}, {3.617895487313188*^9, 3.617895668794155*^9}, {
   3.617987561909747*^9, 3.617987606880123*^9}, {3.619181859599557*^9, 
   3.6191819137336273`*^9}, {3.61918194606076*^9, 3.6191819761218863`*^9}, {
   3.61918228016075*^9, 3.6191822808388367`*^9}, {3.619182371298818*^9, 
   3.6191823857139072`*^9}, {3.619183134504767*^9, 3.619183151964926*^9}, {
   3.619183452706986*^9, 3.619183622135775*^9}, {3.619183657293627*^9, 
   3.619183661669661*^9}, {3.61918493405335*^9, 3.6191851258313828`*^9}, {
   3.6198909520187283`*^9, 3.619891037300499*^9}, {3.6212952207211857`*^9, 
   3.621295258290058*^9}, {3.621295394948133*^9, 3.6212954004421053`*^9}, {
   3.621295531060644*^9, 3.62129555765018*^9}, {3.621295854579718*^9, 
   3.6212959027620773`*^9}, {3.62129603584092*^9, 3.621296089255082*^9}, {
   3.621296163762587*^9, 3.621296181844698*^9}, {3.621296213135891*^9, 
   3.6212962152637043`*^9}, {3.6212962595757017`*^9, 3.621296296348618*^9}, {
   3.621296350266342*^9, 3.621296383094267*^9}, {3.621296421327587*^9, 
   3.621296434988799*^9}, {3.6213383776795197`*^9, 3.621338488850191*^9}, {
   3.6213385669111357`*^9, 3.6213386690176487`*^9}, {3.621346979479034*^9, 
   3.6213470153162603`*^9}, {3.621347081253199*^9, 3.621347196426869*^9}, {
   3.621347234604886*^9, 3.621347253441663*^9}, {3.6213473157698603`*^9, 
   3.6213473582005987`*^9}, {3.621347397469709*^9, 3.621347414996468*^9}, {
   3.621347446362543*^9, 3.6213474737772837`*^9}, {3.62136013580735*^9, 
   3.621360137206524*^9}, 3.621366689864914*^9, {3.621367290492227*^9, 
   3.6213673010721073`*^9}, {3.621375548709317*^9, 3.621375580830884*^9}, 
   3.624299514734805*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"OGTO", " ", "direct", " ", "overlap", " ", "density"}], " ", 
     "&"}], " ", "distance"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rhoD", "[", 
      RowBox[{"xA_List", ",", "x_List", ",", "sigma_"}], "]"}], ":=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"delta", "[", 
        RowBox[{"x", ",", 
         RowBox[{"xA", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "sigma"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "xA", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dotD", "[", 
      RowBox[{"xA_List", ",", "xB_List", ",", "sigma_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{
         RowBox[{"xA", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"xB", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", "sigma"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "xA", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "xB", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"distD", "[", 
     RowBox[{"xA_List", ",", "xB_List", ",", "sigma_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"dotD", "[", 
       RowBox[{"xA", ",", "xA", ",", "sigma"}], "]"}], "+", 
      RowBox[{"dotD", "[", 
       RowBox[{"xB", ",", "xB", ",", "sigma"}], "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"dotD", "[", 
        RowBox[{"xA", ",", "xB", ",", "sigma"}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, {3.6177338648770723`*^9, 
   3.617733873568713*^9}, {3.61784589102752*^9, 3.617845891747086*^9}, {
   3.619184705775597*^9, 3.6191847291402197`*^9}, {3.619185200917454*^9, 
   3.619185201851987*^9}, {3.619891048858486*^9, 3.6198910501455584`*^9}, {
   3.6198935200645237`*^9, 3.619893524296439*^9}, {3.621358551157193*^9, 
   3.6213585525562057`*^9}, {3.6213589985983963`*^9, 3.62135899982253*^9}, {
   3.6213597443828278`*^9, 3.62135989654811*^9}, {3.6213601591415043`*^9, 
   3.621360246100307*^9}, {3.6213603492465487`*^9, 3.621360374829625*^9}, {
   3.6213604215917253`*^9, 3.621360425643936*^9}, {3.6213604848624363`*^9, 
   3.6213607434996567`*^9}, {3.621361008214682*^9, 3.621361044162785*^9}, {
   3.6213610842669*^9, 3.621361096321116*^9}, {3.624299606044635*^9, 
   3.624299618921212*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", "rotation", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Rangle", "[", 
      RowBox[{"angle1_", ",", "angle2_", ",", "angle3_"}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"angle1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"angle2", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"angle3", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Rot", "[", 
      RowBox[{"R_", ",", "x_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"R", ".", "#"}], " ", "&"}], ",", "x"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6025368459662848`*^9, 3.602537260642577*^9}, {
   3.60254357375296*^9, 3.602543580543214*^9}, {3.60254364516962*^9, 
   3.6025436540579042`*^9}, {3.602543752958891*^9, 3.6025437756160707`*^9}, {
   3.60254381614264*^9, 3.6025438650326023`*^9}, {3.6025439157442513`*^9, 
   3.602544200195181*^9}, {3.6025442651616907`*^9, 3.602544275191845*^9}, {
   3.602544312627843*^9, 3.602544369468319*^9}, {3.60254441062918*^9, 
   3.602544491414486*^9}, {3.602544554512451*^9, 3.602544615378072*^9}, {
   3.602544648423978*^9, 3.6025447100102453`*^9}, {3.602552951622966*^9, 
   3.60255307179422*^9}, {3.602553146963511*^9, 3.602553181201688*^9}, {
   3.617560302638402*^9, 3.6175603849326973`*^9}, {3.617560488803426*^9, 
   3.6175605428627853`*^9}, {3.6175606149189262`*^9, 
   3.6175606909984922`*^9}, {3.6175608078710337`*^9, 
   3.6175608306909122`*^9}, {3.617560987018297*^9, 3.6175609903476458`*^9}, {
   3.6175610851959867`*^9, 3.6175611048889637`*^9}, {3.617561135880375*^9, 
   3.617561179048376*^9}, {3.6175613110598717`*^9, 3.617561414164213*^9}, 
   3.617561490817786*^9, {3.617561814701221*^9, 3.617561883520733*^9}, {
   3.617562345074059*^9, 3.61756239582498*^9}, {3.617562438327284*^9, 
   3.61756267431689*^9}, {3.6175627283148212`*^9, 3.617562757749099*^9}, {
   3.617562788465951*^9, 3.617562788697569*^9}, {3.617562820744451*^9, 
   3.6175630294903297`*^9}, {3.617563137449728*^9, 3.617563138560006*^9}, {
   3.617563183173032*^9, 3.617563280801282*^9}, {3.617564782804394*^9, 
   3.6175648388529863`*^9}, {3.6175664873644543`*^9, 3.617566511990752*^9}, {
   3.617567477562612*^9, 3.617567486802438*^9}, {3.6177338648770723`*^9, 
   3.617733873568713*^9}, {3.61784589102752*^9, 3.617845891747086*^9}, {
   3.619184705775597*^9, 3.6191847291402197`*^9}, {3.619185200917454*^9, 
   3.619185201851987*^9}, {3.619891048858486*^9, 3.6198910501455584`*^9}, {
   3.6198935200645237`*^9, 3.619893524296439*^9}, {3.621358551157193*^9, 
   3.6213585525562057`*^9}, {3.62135896030263*^9, 3.6213589955711718`*^9}, {
   3.6218775167559853`*^9, 3.621877567903934*^9}, {3.621877628864511*^9, 
   3.621877682957488*^9}, {3.621877757698905*^9, 3.621877804032099*^9}, {
   3.62187811788948*^9, 3.621878161166872*^9}, {3.621878233167858*^9, 
   3.621878302911735*^9}, {3.622200403362996*^9, 3.622200415445677*^9}, {
   3.624299632345736*^9, 3.624299636704093*^9}, {3.624324962701042*^9, 
   3.6243249690428877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SOAP", " ", 
     RowBox[{"density", ":", " ", 
      RowBox[{"spherical", " ", "harmonic"}]}]}], ",", " ", 
    RowBox[{"see", " ", "Bartok", " ", "2013", " ", "eq", " ", "31"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
     RowBox[{
      RowBox[{"BARTOK", "'"}], "s", " ", 
      RowBox[{"1", "/", "s"}]}], " ", "=", " ", 
     RowBox[{"2", " ", 
      RowBox[{"sigma", "^", "2"}]}]}], ")"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "using", " ", "Legendre", " ", "polynomials", " ", "for", " ", "radial", 
    " ", "basis"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "cl", ",", "l", ",", "m", ",", "theta", ",", "phi", ",", "sigma", ",", 
      "r", ",", "rA", ",", "x1", ",", "x2", ",", "rho"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "l", ",", "m", ",", "theta", ",", "phi", ",", "sigma", ",", "r", ",", 
      "x1", ",", "x2", ",", "rho"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"YY", "[", 
      RowBox[{"l_", ",", "m_", ",", "theta_", ",", "phi_"}], "]"}], "=", 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"l", ",", "m", ",", "theta", ",", "phi"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl", "[", 
      RowBox[{"l_", ",", "r_", ",", "rA_", ",", "sigma_"}], "]"}], " ", "=", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "^", "2"}], "+", 
           RowBox[{"rA", "^", "2"}]}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"sigma", "^", "2"}]}], ")"}]}], "]"}], 
      RowBox[{"modSphBesselI", "[", 
       RowBox[{"l", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", " ", "rA"}], ")"}], "/", 
         RowBox[{"sigma", "^", "2"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rhoS", "[", 
      RowBox[{"xA_List", ",", "x_List", ",", "p_", ",", "sigma_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "rA", ",", 
         RowBox[{"rho", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"cart2sphPolar", "[", "x", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rA", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"cart2sphPolar", ",", "xA"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rho", "=", 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sum", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"cl", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"rA", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "sigma"}], 
                 "]"}], " ", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"YY", "[", 
                  RowBox[{"l", ",", "m", ",", 
                   RowBox[{"rA", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"rA", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], 
                RowBox[{"YY", "[", 
                 RowBox[{"l", ",", "m", ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "xA", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"l", ",", "0", ",", "p"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "rho"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.617566039735093*^9, 3.617566047705255*^9}, {
   3.617566079410152*^9, 3.617566080102085*^9}, {3.617566112262459*^9, 
   3.617566116522854*^9}, {3.617566170313662*^9, 3.617566188311776*^9}, {
   3.617735728992257*^9, 3.617735729230865*^9}, {3.617735813359728*^9, 
   3.617735815518363*^9}, {3.617736111479424*^9, 3.6177361148641987`*^9}, {
   3.617736150613954*^9, 3.6177361947336407`*^9}, {3.6177367594394617`*^9, 
   3.617736760861311*^9}, {3.617736832727475*^9, 3.617736941693804*^9}, {
   3.617741884413229*^9, 3.6177419030422277`*^9}, {3.617741940648252*^9, 
   3.617742002107532*^9}, {3.617742067488245*^9, 3.61774233930869*^9}, {
   3.617743396566505*^9, 3.617743401063891*^9}, {3.617743445690844*^9, 
   3.617743580973792*^9}, {3.617743640471859*^9, 3.617743666649261*^9}, {
   3.6177437018253183`*^9, 3.61774370266846*^9}, {3.6177437593965397`*^9, 
   3.61774378580766*^9}, {3.617743837385446*^9, 3.617743848824048*^9}, {
   3.617744096384666*^9, 3.617744097535056*^9}, {3.617744129519247*^9, 
   3.617744148182934*^9}, {3.6177461112812853`*^9, 3.617746120437235*^9}, {
   3.617747611994183*^9, 3.617747627459722*^9}, 3.6177492364022408`*^9, {
   3.617754047975648*^9, 3.617754065013133*^9}, {3.617755165353257*^9, 
   3.617755169878655*^9}, {3.617755316480879*^9, 3.6177553685620747`*^9}, {
   3.6177554185772877`*^9, 3.617755465020174*^9}, {3.617755510955558*^9, 
   3.617755511218479*^9}, {3.617755542676344*^9, 3.617755610585752*^9}, {
   3.617755652781419*^9, 3.617755747454136*^9}, {3.617755797977522*^9, 
   3.617755827550997*^9}, {3.617755895863818*^9, 3.617755916390244*^9}, {
   3.617755959293264*^9, 3.6177559739242887`*^9}, 3.6177560111104507`*^9, {
   3.617756119144458*^9, 3.617756171055271*^9}, {3.6177563414799843`*^9, 
   3.617756355550438*^9}, {3.617756710870572*^9, 3.617756744274817*^9}, {
   3.61775746792632*^9, 3.617757468361289*^9}, {3.617757675221064*^9, 
   3.6177577709180307`*^9}, {3.6177578674463*^9, 3.617757868382717*^9}, 
   3.617757924586348*^9, {3.617757965787183*^9, 3.617757966121995*^9}, {
   3.6177580701634407`*^9, 3.617758073715746*^9}, {3.617758202352293*^9, 
   3.617758207195622*^9}, {3.617758251969591*^9, 3.617758267029768*^9}, {
   3.61775836141249*^9, 3.6177583651687593`*^9}, {3.617759354927753*^9, 
   3.6177594029575777`*^9}, {3.617759724538529*^9, 3.617759754493692*^9}, {
   3.617760141347845*^9, 3.61776015127383*^9}, {3.617760227389605*^9, 
   3.617760227831345*^9}, {3.617761544978848*^9, 3.617761549396298*^9}, {
   3.617761582867354*^9, 3.617761607807126*^9}, {3.6177617319190187`*^9, 
   3.617761743573357*^9}, {3.617761814797927*^9, 3.617761821088282*^9}, {
   3.6177619672057247`*^9, 3.6177619978741627`*^9}, {3.6177620618952312`*^9, 
   3.6177620650206203`*^9}, {3.617762116431476*^9, 3.617762149917303*^9}, {
   3.617762204012907*^9, 3.617762219636071*^9}, {3.61776226367134*^9, 
   3.617762283715167*^9}, {3.617762421361454*^9, 3.617762424391842*^9}, {
   3.6177625018393784`*^9, 3.617762504886759*^9}, {3.617762549349332*^9, 
   3.617762553004733*^9}, {3.617762636697949*^9, 3.617762637120989*^9}, {
   3.617762692928546*^9, 3.6177627171448936`*^9}, {3.6177627495816927`*^9, 
   3.617762772571766*^9}, {3.617842256370386*^9, 3.617842257540354*^9}, {
   3.6178424288072863`*^9, 3.617842471409083*^9}, 3.6178428542294292`*^9, {
   3.617842889659377*^9, 3.617842911418466*^9}, {3.6178429600622272`*^9, 
   3.61784296158486*^9}, {3.617843160587696*^9, 3.617843174175048*^9}, {
   3.617843226608734*^9, 3.6178432426348543`*^9}, {3.617843629068734*^9, 
   3.6178437700770483`*^9}, {3.6178438117057467`*^9, 3.617843825559926*^9}, {
   3.617843857521985*^9, 3.617843858223411*^9}, {3.617843978544351*^9, 
   3.6178439790326014`*^9}, {3.6178440331201344`*^9, 3.617844039263905*^9}, {
   3.617844184784301*^9, 3.617844185811798*^9}, {3.617844220214201*^9, 
   3.617844238744914*^9}, {3.617844285968704*^9, 3.6178442868178062`*^9}, {
   3.617844381966742*^9, 3.6178443893618917`*^9}, {3.6178444728744383`*^9, 
   3.617844473309367*^9}, {3.617844568438973*^9, 3.6178445687777452`*^9}, {
   3.61868103630415*^9, 3.618681067078363*^9}, {3.618681110679685*^9, 
   3.618681184488011*^9}, {3.6186812308867683`*^9, 3.618681243004682*^9}, {
   3.619185606124114*^9, 3.619185613848551*^9}, {3.619185862217876*^9, 
   3.619185864793663*^9}, {3.619473333242506*^9, 3.619473338738312*^9}, {
   3.619482446770988*^9, 3.619482453138876*^9}, {3.61948249654213*^9, 
   3.6194825385668297`*^9}, {3.619482760238783*^9, 3.619482879678363*^9}, {
   3.619483079247959*^9, 3.619483089479793*^9}, {3.619483541218711*^9, 
   3.619483636496441*^9}, {3.6198908404331083`*^9, 3.619890845433642*^9}, {
   3.619891153689025*^9, 3.6198911722871304`*^9}, {3.6198913080273647`*^9, 
   3.619891317267359*^9}, {3.619891940384413*^9, 3.619891967085576*^9}, {
   3.624299650110416*^9, 3.624299660551111*^9}, {3.62430062653478*^9, 
   3.6243006415808277`*^9}, {3.6243212632045593`*^9, 3.624321293770598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "inner", " ", "product", " ", "of", " ", "the", " ", 
    "expansions", " ", "rhoA", " ", "and", " ", "rhoB", " ", "to", " ", 
    "order", " ", "l"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "r", ",", "rr", ",", "x1", ",", "x2", ",", "l", ",", "m1", ",", "m2", 
      ",", "sigma"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "[", 
      RowBox[{"r_", ",", "sigma_"}], "]"}], " ", "=", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "^", "2"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", 
         RowBox[{"sigma", "^", "2"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wg", "[", 
      RowBox[{"rr_", ",", "l_", ",", "sigma_"}], "]"}], "=", " ", 
     RowBox[{"4", " ", "Pi", " ", 
      RowBox[{"modSphBesselI", "[", 
       RowBox[{"l", ",", 
        RowBox[{"rr", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"II", "[", 
      RowBox[{
      "x1_List", ",", "x2_List", ",", "l_", ",", "m1_", ",", "m2_", ",", 
       "sigma_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sum", "=", "0"}], ",", "w", ",", "Y1", ",", "Y2", ",", "n1",
          ",", "n2", ",", "C1", ",", "C2", ",", "c2", ",", "c1", ",", "phi1", 
         ",", "phi2", ",", "theta1", ",", "theta2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n1", "=", 
         RowBox[{"Length", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n2", "=", 
         RowBox[{"Length", "[", "x2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"C1", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"cart2sphPolar", ",", "x1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"C2", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"cart2sphPolar", ",", "x2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sum", " ", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "=", " ", 
            RowBox[{"C1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"r1", " ", "=", " ", 
            RowBox[{"c1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"theta1", " ", "=", " ", 
            RowBox[{"c1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"phi1", " ", "=", " ", 
            RowBox[{"c1", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"exp1", "=", 
            RowBox[{"exp", "[", 
             RowBox[{"r1", ",", "sigma"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Y1", " ", "=", 
            RowBox[{"exp1", " ", "*", 
             RowBox[{"YY", "[", 
              RowBox[{"l", ",", "m1", ",", "theta1", ",", "phi1"}], "]"}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"c2", "=", " ", 
               RowBox[{"C2", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"r2", " ", "=", " ", 
               RowBox[{"c2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"theta2", "=", " ", 
               RowBox[{"c2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"phi2", " ", "=", " ", 
               RowBox[{"c2", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"exp2", "=", 
               RowBox[{"exp", "[", 
                RowBox[{"r2", ",", "sigma"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Y2", " ", "=", 
               RowBox[{"exp2", "*", 
                RowBox[{"YY", "[", 
                 RowBox[{"l", ",", "m2", ",", "theta2", ",", "phi2"}], 
                 "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"w", "=", " ", 
               RowBox[{"wg", "[", 
                RowBox[{
                 RowBox[{"r1", " ", "r2"}], ",", "l", ",", " ", "sigma"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"N", "[", "w", "]"}], ",", "\"\<:\>\"", ",", 
                  RowBox[{"N", "[", "Y1", "]"}], ",", "\"\<:\>\"", ",", 
                  RowBox[{"N", "[", "Y2", "]"}]}], "]"}], ";"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"kernel", " ", "=", "  ", 
               RowBox[{"w", "*", 
                RowBox[{"Conjugate", "[", "Y1", "]"}], "*", "Y2"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sum", " ", "+=", "kernel"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "n2"}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "n1"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "sum"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0F0oQ3EABfAbDSsfS4sSLVGiyJMsXm7m+1q5yxSLqI0kwx6WNYqSTLGF
ssIDi9rUlvaiIWqUEmWK5IWG2qz5mH0wcc//4fR7OJ2Xk9+rZpUJFEXlcYGP
0xHr16eP1pjCNhgRBeywQZLogAJVihNWuozEaX6TC2Z+zx7AKJWpCHMKpz6J
TNHOALwKUmq48V2oh/u7qcvQfiy/hEHbNbH6aclLerHuGX4U9+h/OZPdgUko
DobbW0I+Ok0S6oUGTWkfnD9aIv4dugbha8GiBgqTzVrobdsiMnsTC1BtLTRB
0Y0gBnO0FT9kH2PEUk7/W30VvH1xD0O+Mz4CtxeHxuC7ql4HH+aYW9hvsBDj
0s1HyLJe4uiqIQxPKFkMWq1fneaIj57JYhWw+WxypS/K/ZPNM8NTXqu8LO6j
lSV3XdAS4jFizvS1chlMEtVpodTjIOZKOhrPOWuMnm44fr+ecUH5aUXtmwD+
A1LgFDk=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ymatrix", "[", 
     RowBox[{"x1_List", ",", "l_", ",", "sigma_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sum", "=", "0"}], ",", "w", ",", "Y1", ",", "n1", ",", "C1", 
        ",", "c1", ",", "phi1", ",", "theta1", ",", "Ymat"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ymat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"2", "l"}], "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"cart2sphPolar", ",", "x1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"sum", " ", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"c1", "=", " ", 
              RowBox[{"C1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"theta1", " ", "=", " ", 
              RowBox[{"c1", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"phi1", " ", "=", " ", 
              RowBox[{"c1", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Ymat", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"m1", "+", "l", "+", "1"}], ",", "i1"}], "]"}], 
               "]"}], " ", "=", 
              RowBox[{"YY", "[", 
               RowBox[{"l", ",", "m1", ",", "theta1", ",", "phi1"}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n1"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", 
           RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "Ymat"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wmatrix", "[", 
    RowBox[{"x1_List", ",", "x2_List", ",", "l_", ",", "sigma_"}], "]"}], " ",
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sum", "=", "0"}], ",", "w", ",", "Y1", ",", "Y2", ",", "n1", 
       ",", "n2", ",", "C1", ",", "C2", ",", "c2", ",", "c1", ",", "phi1", 
       ",", "phi2", ",", "theta1", ",", "theta2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n1", "=", 
       RowBox[{"Length", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{"Length", "[", "x2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C1", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"cart2sphPolar", ",", "x1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"C2", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"cart2sphPolar", ",", "x2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Wmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"c1", "=", " ", 
          RowBox[{"C1", "[", 
           RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"r1", " ", "=", " ", 
          RowBox[{"c1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"exp1", "=", 
          RowBox[{"exp", "[", 
           RowBox[{"r1", ",", "sigma"}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"c2", "=", " ", 
             RowBox[{"C2", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"r2", " ", "=", " ", 
             RowBox[{"c2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"exp2", "=", 
             RowBox[{"exp", "[", 
              RowBox[{"r2", ",", "sigma"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Wmat", "[", 
              RowBox[{"[", 
               RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", " ", 
             RowBox[{"exp1", "*", "exp2", "*", 
              RowBox[{"wg", "[", 
               RowBox[{
                RowBox[{"r1", " ", "r2"}], ",", "l", ",", " ", "sigma"}], 
               "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "n2"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "n1"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "Wmat"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.617566039735093*^9, 3.617566047705255*^9}, {
   3.617566079410152*^9, 3.617566080102085*^9}, {3.617566112262459*^9, 
   3.617566116522854*^9}, {3.617566170313662*^9, 3.617566188311776*^9}, {
   3.6175674565626183`*^9, 3.6175674636096287`*^9}, {3.617567573379797*^9, 
   3.617567608029275*^9}, {3.617567713155595*^9, 3.617567912396818*^9}, {
   3.617568378711143*^9, 3.617568382645988*^9}, {3.6175685486529827`*^9, 
   3.6175685638195477`*^9}, {3.6175820510363703`*^9, 3.617582095430179*^9}, {
   3.617745599716702*^9, 3.617745687633307*^9}, {3.617745721420354*^9, 
   3.617745724648505*^9}, {3.617745765867065*^9, 3.617745820598135*^9}, {
   3.617745852782114*^9, 3.6177458531979847`*^9}, {3.6177460439601192`*^9, 
   3.617746057145805*^9}, {3.61774688852626*^9, 3.617746905702039*^9}, {
   3.617747402405517*^9, 3.617747418248159*^9}, {3.6177478461533012`*^9, 
   3.617747855896977*^9}, {3.617747915455524*^9, 3.617747922231316*^9}, {
   3.617748674392075*^9, 3.6177486771418953`*^9}, {3.6177487571033916`*^9, 
   3.617748759135049*^9}, {3.6177489163315973`*^9, 3.617748938593844*^9}, {
   3.619474143677083*^9, 3.61947414656525*^9}, {3.619896516055822*^9, 
   3.6198965201591578`*^9}, {3.621876402531955*^9, 3.621876470817675*^9}, {
   3.6218988481861134`*^9, 3.6218989055191717`*^9}, {3.621899194191287*^9, 
   3.621899197525794*^9}, {3.622199882820814*^9, 3.622200065843977*^9}, {
   3.6222011641670732`*^9, 3.6222013393343554`*^9}, {3.6222013836963263`*^9, 
   3.622201606324299*^9}, {3.622201747975932*^9, 3.622201748422062*^9}, {
   3.6222024744189177`*^9, 3.622202476802773*^9}, {3.622202517066927*^9, 
   3.622202538449893*^9}, 3.624300706266852*^9, 3.624472421864716*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "I1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Imatrix", "[", 
    RowBox[{"xA_List", ",", "xB_List", ",", "l_", ",", "sigma_"}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"II", "[", 
        RowBox[{
        "xA", ",", "xB", ",", "l", ",", "m1", ",", "m2", ",", "sigma"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"m1", ",", 
         RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m2", ",", 
       RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1", "[", 
    RowBox[{"xA_List", ",", "xB_List", ",", "sigma_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Imatrix", "[", 
    RowBox[{"xA", ",", "xB", ",", "1", ",", "sigma"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dotS", "[", 
    RowBox[{"xA_List", ",", "xB_List", ",", "l_", ",", "sigma_"}], "]"}], ":=",
    " ", 
   RowBox[{"Tr", "[", 
    RowBox[{"Imatrix", "[", 
     RowBox[{"xA", ",", "xB", ",", "l", ",", "sigma"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"distS", "[", 
    RowBox[{"xA_List", ",", "xB_List", ",", "l_", ",", "sigma_"}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"dotS", "[", 
      RowBox[{"xA", ",", "xA", ",", "l", ",", "sigma"}], "]"}], "+", 
     RowBox[{"dotS", "[", 
      RowBox[{"xB", ",", "xB", ",", "l", ",", "sigma"}], "]"}], "-", 
     RowBox[{"2", 
      RowBox[{"dotS", "[", 
       RowBox[{"xA", ",", "xB", ",", "l", ",", "sigma"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0FsoQ3EABvCDZlZoSZRkiRJFnmTNy6nleqxMppBY7RIy7GHRUlNLJrdQ
VrywqE1tyYuGyKWUUihLXsxQcxk2ZzbTnO//8PV7+PpevnylTq5KpCgqjwv0
msP276Cf1s+xDhgWvTlhrTTJBYXqlG1Y6Z4lmgX1bpgRndiDP1RGB8uZORYk
MkWbPfAyQOngarTQCHe3Uheh81BxAQOOa2LV44KP9OKRJ/hV3G384+Qfv5mg
OMC2Nob8dJo0pIQWfakGTh8sEOP77j74WjCvh5l8qwH6WtaJzM7oDNTZC+eg
6EYYgTmGil+yjzBiGefLR40Eep6PB6BgOzYIN+b7h+GnumYE3k8yHqi12Igx
2ZoXyuU+4tCyhYUnVHME2u3f7dawnx7PknfAhjPTkuaH+yebZ4WnvCZFWcxP
q0puO6EtxGPEnOkr5c0wWVRtgLIrFzFX2lZ3znmXIOmCWsnDe37CC9075Q5A
z5CNhT7mKA7/AdDBHDY=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"rotation", " ", "of", " ", "SOAP", " ", "representation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Wigner", " ", "\"\<big\>\"", " ", "D", " ", "matrix"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Dl", "[", 
      RowBox[{"l_", ",", "psi_", ",", "phi_", ",", "theta_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{"2", "l"}], "+", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DD", " ", "=", " ", 
         RowBox[{"0", "*", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"i", " ", "=", 
              RowBox[{"m1", "+", "l", "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"j", "=", " ", 
              RowBox[{"m2", "+", "l", "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DD", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"WignerD", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"l", ",", "m1", ",", "m2"}], "}"}], ",", "psi", ",", 
                "phi", ",", "theta"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"m1", ",", 
              RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m2", ",", 
            RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "DD"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "D1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D1", "[", 
      RowBox[{"psi_", ",", "phi_", ",", "theta_"}], "]"}], " ", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WignerD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "i", ",", "j"}], "}"}], ",", "psi", ",", "theta", 
         ",", "phi"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RotI", "[", 
      RowBox[{
      "A_List", ",", "B_List", ",", "R_List", ",", "l_", ",", "sigma_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s1", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"cart2sphPolar", ",", "A"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s2", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"cart2sphPolar", ",", 
           RowBox[{"Rot", "[", 
            RowBox[{"R", ",", "B"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Imatrix", "[", 
         RowBox[{"s1", ",", "s2", ",", "l", ",", "sigma"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.617566039735093*^9, 3.617566047705255*^9}, {
   3.617566079410152*^9, 3.617566080102085*^9}, {3.617566112262459*^9, 
   3.617566116522854*^9}, {3.617566170313662*^9, 3.617566188311776*^9}, 
   3.6175674565626183`*^9, 3.617736798086651*^9, {3.617754458192318*^9, 
   3.617754597173208*^9}, {3.617754670747796*^9, 3.617754688506773*^9}, {
   3.619187988438901*^9, 3.619187989678*^9}, {3.620603689651169*^9, 
   3.620603715267261*^9}, {3.6243249911405163`*^9, 3.624324995963436*^9}, {
   3.6244140893726473`*^9, 3.624414113612526*^9}, {3.624414143762341*^9, 
   3.624414165153966*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"eq", " ", "3.30", " ", "of", " ", "Biedenhorn"}], " ", "&"}], 
    " ", "Louck", " ", "is", " ", "a", " ", "general", " ", "map", " ", 
    "between", " ", "R", " ", "and", " ", "D_", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<A= \>\"", ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0", ",", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "I"}], "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"At", " ", "=", " ", 
     RowBox[{"ConjugateTranspose", "[", "A", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D1toR", "[", "D1_List", "]"}], " ", ":=", " ", 
     RowBox[{"A", ".", "D1", ".", "At"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RtoD1", "[", "R_List", "]"}], ":=", 
     RowBox[{"At", ".", "R", ".", "A"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.617566039735093*^9, 3.617566047705255*^9}, {
   3.617566079410152*^9, 3.617566080102085*^9}, {3.617566112262459*^9, 
   3.617566116522854*^9}, {3.617566170313662*^9, 3.617566178642172*^9}, 
   3.619188008684692*^9, {3.620603818918538*^9, 3.620603834881274*^9}, {
   3.6218765140213823`*^9, 3.6218765589667597`*^9}, {3.621880523174341*^9, 
   3.621880538028829*^9}, {3.621897551080564*^9, 3.621897560236305*^9}, {
   3.6242997256164837`*^9, 3.624299730940474*^9}, 3.6243214647333193`*^9, {
   3.624321503076579*^9, 3.624321514234723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotD", "[", 
   RowBox[{"xA_List", ",", "xB_List", ",", "sigma_"}], "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "R", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FindMinimum", "[", 
      RowBox[{
       RowBox[{"RdistD", "[", 
        RowBox[{"xA", ",", "xB", ",", "sigma"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"theta", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"phi", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"psi", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "R"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.620648172163849*^9, 3.6206481909278097`*^9}, {
  3.6206483071115313`*^9, 3.6206483504134073`*^9}, {3.6206484466481047`*^9, 
  3.620648461767351*^9}, {3.6206485433601007`*^9, 3.620648596566964*^9}, {
  3.6243214519265537`*^9, 3.624321467037178*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WignerD", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "psi", ",", "theta", ",", 
    "phi"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "D1", "]"}]}], "Input",
 CellChangeTimes->{{3.621356709795742*^9, 3.62135681866995*^9}, {
  3.62441405738412*^9, 3.624414082885723*^9}}]
},
WindowSize->{1228, 756},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>2. Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 3317, 59, 123, "Input"],
Cell[3877, 81, 4441, 91, 387, "Input"],
Cell[8321, 174, 2799, 49, 123, "Input"],
Cell[11123, 225, 6774, 144, 486, "Input"],
Cell[17900, 371, 4273, 89, 288, "Input"],
Cell[22176, 462, 3467, 64, 255, "Input"],
Cell[25646, 528, 9658, 190, 849, "Input"],
Cell[35307, 720, 6362, 151, 1179, "Input"],
Cell[41672, 873, 7211, 161, 1245, "Input"],
Cell[48886, 1036, 2321, 64, 355, "Input"],
Cell[51210, 1102, 4171, 105, 684, "Input"],
Cell[55384, 1209, 2200, 54, 321, "Input"],
Cell[57587, 1265, 989, 25, 156, "Input"],
Cell[58579, 1292, 394, 9, 123, "Input"]
}
]
*)

(* End of internal cache information *)
